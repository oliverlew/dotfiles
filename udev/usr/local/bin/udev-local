#!/bin/sh
export PATH="/home/$XUSER/.local/bin:$PATH"

case "$1" in
capslock)
    notify-send -i "input-keyboard" -a "New keyboard" "Mapping CapsLock -> Escape."
    sleep 1 # xmodmap won't work on new keyboards without this delay
    xmodmap -e "clear Lock" -e "keycode 0x42 = Escape Caps_Lock"
    ;;
ac)
    status=$([ "$2" = 1 ] && echo on || echo off)
    notify-send -i "battery" -a "Power supply" "AC adapter $status"
    ;;
drm)
    notify-send -i "video-display" -a "Display" "External monitor changed"
    setmonitor -q
    ;;
usb)
    notify-send "USB Storage $2 ${ACTION%e}ed" "$3 $4"
    ;;
mount)
    # should be called as root
    [ "$ACTION" = add ] || exit
    sleep 1
    LABEL=$(lsblk -n -o LABEL,UUID "$2" | { read -r l _; echo "$l"; })
    systemd-mount --no-block --collect "$2" "/run/media/$XUSER/$LABEL"
    ;;
esac
