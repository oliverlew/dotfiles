#!/bin/sh
while getopts o:s:t:h arg; do
    case "$arg" in
        o) output=$OPTARG ;;
        s) size=$OPTARG ;;
        t) time=$OPTARG ;;
        h|*) echo "$(basename "$0") [-o BASENAME] [-s WIDTH] [-t SECONDS]" && exit;;
    esac
done
shift $((OPTIND - 1))

for v in "$@"; do
    [ "${v#-}" != "$v" ] && echo "ignoreing $v" && continue
    ffmpeg -y -t "${time:-300}" -i "$v" -r 15 \
        -vcodec "cinepak" -min_strips 3 \
        -vf "scale=${size:-320}:-1" \
        -acodec "pcm_u8" -ac 2 -ar 22050 \
        "${output:-${v%.*}-old}.avi"
done
